
#**行为克隆**

##编写模板

###如果您想将此文件作为一个缩写文件提交，您可以使用此文件作为模板，但如果您喜欢，请随时使用其他方法并提交pdf

---

**行为克隆项目**

本项目的目标/步骤如下：
*使用模拟器收集良好驾驶行为的数据
*构建，克拉斯卷积神经网络，预测图像的转向角度
*训练和验证模型与训练和验证集
*测试模型成功驾驶轨道一
*用书面报告总结结果

[//]: # (Image References)

[image1]: ./examples/placeholder.png "Model Visualization"

专栏
###在这里我将分别考虑[rubric points]（https://review.udacity.com/#!/rubrics/432/view），并描述我在实现过程中对每一个问题的解决方法。

---
###提交的文件和代码质量

#### 1.提交包括所有必需的文件，可用于以自主模式运行模拟器

我的项目包括以下文件：
* Model.py包含用于创建和训练模型的脚本
* Drive.py用于以自主模式驾驶汽车
* Model.h5包含训练有素的卷积神经网络
* Writeup_report.md或writeup_report.pdf总结结果

#### 2.提交内容包括功能码
使用Udacity提供的模拟器和我的drive.py文件，汽车可以通过执行自主地围绕轨道
```
Python drive.py model.h5
````

#### 3.提交代码是可用和可读的

该文件显示训练代码并保存卷积神经网络。该文件显示了我用于训练和验证模型的管道，它包含了解释代码如何工作的注释。

###模型架构与培训策略

#### 1.已经采用了适当的模型架构

我的模型由一个卷积神经网络组成，具有3个具有5x5滤波器的卷积层和2个具有3x3滤波器的卷积层。接下来是3个完全连接的层和转向角预测值的最后一层（model.py行57-69）

该模型包括用于封装非线性（代码行60-62）的RELU层，并且使用Keras lambda层（代码行58）在模型中对数据进行归一化。
根据课程中的建议，我添加了一个Cropping2D层，可用于选择排除天空和/或汽车罩的感兴趣区域（代码行59）。

#### 2.试图减少模型中的过度拟合

我决定不通过应用正则化技术（如Dropout或Max pooling）来修改模型。除此之外，我将样本数据分为培训和验证数据。使用80％作为培训，20％作为验证。这可以在代码的这一部分看到。

#### 3.模型参数调整

该模型使用了一个adam优化器，所以学习率没有被手动调整（model.py第71行）。

#### 4.适当的训练数据

选择了训练数据，以保持车辆行驶在道路上。我使用自己在中心车道驾驶的四圈向前跑的数据和三圈反向跑的数据，并且将数据翻转来讲数据翻倍，但是没有使用左右两个相机。

有关我如何创建培训数据的详细信息，请参阅下一节。

###模型架构与培训策略

#### 2.解决方案设计方法

导出模型架构的总体策略是...

我的第一步是使用类似于LetNet的卷积神经网络模型，但是在训练后，车直接报到湖里去了。我需要一些预处理。引入了一个新的Lambda层,将输入图像归一化。这个步骤让汽车可以进一步移动，但是在转弯的时候却不能正确判断。
第二步是使用更强大的模型：nVidia,根据需要输出一个输出，这一次，车可以正常过弯，并且可以通过桥梁，但是在一个右侧没有防护栏的地方，却直接跑出了车道。这一次我将数据进行翻转获的翻倍的数据，并且发现cv2读取的图像颜色空间与模拟器的不一致，将图像的颜色空间进行修正，并使用了generator来将数据进行并行加载。

#### 2.最终模型架构

最后一层建筑（model.py lines 18-24）由一个卷积神经网络组成，

Layer (type)                     Output Shape          Param #     Connected to                     

====================================================================================================

lambda_1 (Lambda)                (None, 160, 320, 3)   0           lambda_input_2[0][0]             

____________________________________________________________________________________________________

cropping2d_1 (Cropping2D)        (None, 90, 320, 3)    0           lambda_1[0][0]                   

____________________________________________________________________________________________________

convolution2d_1 (Convolution2D)  (None, 40, 158, 24)   1824        cropping2d_1[0][0]               

____________________________________________________________________________________________________

convolution2d_2 (Convolution2D)  (None, 20, 77, 36)    21636       convolution2d_1[0][0]                           

____________________________________________________________________________________________________

convolution2d_3 (Convolution2D)  (None, 8, 37, 48)     43248       convolution2d_2[0][0]                       


____________________________________________________________________________________________________

convolution2d_4 (Convolution2D)  (None, 6, 35, 64)     27712       convolution2d_3[0][0]                       


____________________________________________________________________________________________________

convolution2d_5 (Convolution2D)  (None, 4, 33, 64)     36928       convolution2d_4[0][0]                        

____________________________________________________________________________________________________

flatten_1 (Flatten)              (None, 4224)          0           convolution2d_5[0][0] 


____________________________________________________________________________________________________

dense_1 (Dense)                  (None, 100)           844900      flatten_1[0][0]                  

____________________________________________________________________________________________________

dense_2 (Dense)                  (None, 50)            5050        dense_1[0][0]                  

____________________________________________________________________________________________________

dense_3 (Dense)                  (None, 10)            510         dense_2[0][0]                  

____________________________________________________________________________________________________

dense_4 (Dense)                  (None, 1)             11          dense_3[0][0]                    

====================================================================================================
Total params: 981,819
Trainable params: 981,819
Non-trainable params: 0

#### 3。创建培训和培训流程

要获取更多数据，将捕获以下轨道：

第一轨
在一条道路向前推进四圈
在一条道路向后推进三圈。
所有这些数据都用于训练具有五个时期的模型。数据随机洗牌，如下图。

![alt text][image1]

在这次训练之后，这辆车一直沿着道路行驶。